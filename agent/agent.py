from langchain_together import Together
from mcp_adapter import McpAdapter
from langchain.agents import initialize_agent, AgentType
import asyncio

llm = Together(
    model="lgai/exaone-3-5-32b-instruct",
    temperature=0.0,
    max_tokens=200,
)

async def main():
    adapter = await McpAdapter.from_command("python server.py")
    await adapter.initialize()
    tools = await adapter.get_tools()

    agent = initialize_agent(
        tools=tools,
        llm=llm,
        agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,
        verbose=True
    )

    query = (
        "–í–æ—Ç –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –ª–∏–∑–∏–Ω–≥–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:\n"
        '–ö–æ–º–ø–∞–Ω–∏—è: –û–û–û "–°–¢–†–û–ô–ì–†–ê–ù–ò–¢"\n'
        "–î–∞—Ç–∞ –∑–∞–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞: 22.05.2025\n"
        "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ:\n"
        "–ü—Ä–µ–¥–º–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∞—Ä–µ–Ω–¥—ã: –≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä-–ø–æ–≥—Ä—É–∑—á–∏–∫ JCB 3CX\n"
        "–°—Ä–æ–∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∞—Ä–µ–Ω–¥—ã: 22.05.2025 - 22.05.2028\n"
        "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <res>–ü–æ–¥–ø–∏—Å–∞–Ω</res>\n\n"
        "–¢–≤–æ—è –∑–∞–¥–∞—á–∞:\n"
        "1. –ò–∑–≤–ª–µ–∫–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–¥–µ–ª–∫–µ: –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, –ø—Ä–µ–¥–º–µ—Ç –ª–∏–∑–∏–Ω–≥–∞ –∏ –¥–∞—Ç—É –∑–∞–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞. "
        "–û—Ñ–æ—Ä–º–∏ —ç—Ç–æ –≤ –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.\n"
        "2. –û–ø—Ä–µ–¥–µ–ª–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—Ä–µ–¥–º–µ—Ç –ª–∏–∑–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–æ–π. "
        "–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ ‚Äî –≤–µ—Ä–Ω–∏ '400' –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Å—å.\n"
        "3. –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–¥–µ–ª–∫–µ –≤ JSON-—Ñ–∞–π–ª. "
        "–ó–∞–ø–∏—Å–∞—Ç—å –Ω—É–∂–Ω–æ: –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–¥–µ–ª–∫–µ –∏ –æ—Ç–¥–µ–ª—å–Ω–æ –¥–∞—Ç—É.\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ–±–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ. –ù–µ –¥–µ–ª–∞–π —à–∞–≥–∏ —Å–∞–º, –≤—ã–∑—ã–≤–∞–π –Ω—É–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.\n"
        "–ù–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Ç–µ–∫—Å—Ç–µ –ª–∏–∑–∏–Ω–≥–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞."
    )

    result = agent.run(query)
    print("\nüìã FINAL RESULT:")
    print(result)

    await adapter.close()

if __name__ == "__main__":
    asyncio.run(main())
